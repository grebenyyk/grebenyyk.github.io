<!DOCTYPE html>
<html><head lang="en">
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><link rel="icon" href="/favicon.ico" type="image/x-icon"><title>Облучаем и обучаем - Dimitry&#39;s Blog</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="Последние два месяца твиттер только и делает, что обсуждает искусственный интеллект, нейросети и большие языковые модели. Ажиотаж масштабнейший: Майкрософт за неделю прикрутил ChatGPT к поисковику Bing; акции Гугла упали из-за того, что чатбот Bard ошибся на презентации; ChatGPT пишет за студентов дипломы, за кодеров — код; кто-то говорит что это — наше будущее и надо ловить момент; кто-то переживает, что на работе их скоро заменит искусственный интеллект.
Химики и материаловеды тоже не стоят на месте и активно используют машинное обучение в своей практике." />
	<meta property="og:image" content=""/>
	<meta property="og:title" content="Облучаем и обучаем" />
<meta property="og:description" content="Последние два месяца твиттер только и делает, что обсуждает искусственный интеллект, нейросети и большие языковые модели. Ажиотаж масштабнейший: Майкрософт за неделю прикрутил ChatGPT к поисковику Bing; акции Гугла упали из-за того, что чатбот Bard ошибся на презентации; ChatGPT пишет за студентов дипломы, за кодеров — код; кто-то говорит что это — наше будущее и надо ловить момент; кто-то переживает, что на работе их скоро заменит искусственный интеллект.
Химики и материаловеды тоже не стоят на месте и активно используют машинное обучение в своей практике." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://grebenyyk.github.io/posts/ml-pdf/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-02-11T17:13:54+03:00" />
<meta property="article:modified_time" content="2023-02-11T17:13:54+03:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Облучаем и обучаем"/>
<meta name="twitter:description" content="Последние два месяца твиттер только и делает, что обсуждает искусственный интеллект, нейросети и большие языковые модели. Ажиотаж масштабнейший: Майкрософт за неделю прикрутил ChatGPT к поисковику Bing; акции Гугла упали из-за того, что чатбот Bard ошибся на презентации; ChatGPT пишет за студентов дипломы, за кодеров — код; кто-то говорит что это — наше будущее и надо ловить момент; кто-то переживает, что на работе их скоро заменит искусственный интеллект.
Химики и материаловеды тоже не стоят на месте и активно используют машинное обучение в своей практике."/>

        <link href="https://grebenyyk.github.io/css/fonts.2c2227b81b1970a03e760aa2e6121cd01f87c88586803cbb282aa224720a765f.css" rel="stylesheet">
	

	
	<link rel="stylesheet" type="text/css" media="screen" href="https://grebenyyk.github.io/css/main.6a0f23ea50fd34b46fee262a5a68e17d458c51a2bc99ba1ba018065de6b180c3.css" />
		
		
		<link rel="stylesheet" type="text/css" href="https://grebenyyk.github.io/css/custom.898570017cf662a7877cf02bc3758c841a2c350124df1181e33802d85fbbb6f4.css">
		

	
	<link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css" />

	
	<script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
</head>
<body>
        <div class="content"><header>
	<div class="main">
		<a href="https://grebenyyk.github.io/">Dimitry&#39;s Blog</a>
	</div>
	<nav>
		
		<a href="/about">About</a>
		
		<a href="/links">Links</a>
		
		<a href="/posts">All posts</a>
		
		<a href="/tags">Tags</a>
		
		<a href="https://instagram.com/grebenyyk">Instagram</a>
		
		<a href="https://twitter.com/grebenyyk">X</a>
		
		
	</nav>
</header>

<main>
  <article>
    <div class="post-container">
      
      <div class="post-content">
        <div class="title">
          <h1 class="title">Облучаем и обучаем</h1>
          <div class="meta">Posted on Feb 11, 2023</div>
        </div>
        
        <section class="body">
          <p>Последние два месяца твиттер только и делает, что обсуждает искусственный интеллект, нейросети и большие языковые модели. Ажиотаж масштабнейший: Майкрософт за неделю <a href="https://www.theverge.com/2023/2/7/23587454/microsoft-bing-edge-chatgpt-ai">прикрутил ChatGPT</a> к поисковику Bing; <a href="https://edition.cnn.com/2023/02/08/tech/google-ai-bard-demo-error/index.html">акции Гугла упали</a> из-за того, что чатбот Bard ошибся на презентации; ChatGPT пишет за студентов дипломы, за кодеров — код; кто-то говорит что это — наше будущее и надо ловить момент; кто-то переживает, что на работе их скоро заменит искусственный интеллект.</p>
<p>Химики и материаловеды тоже не стоят на месте и активно используют машинное обучение в своей практике. Хотя в некоторых уважаемых журналах <a href="https://www.nature.com/articles/s41586-022-05543-x">пишут</a>, что все-таки стоят. Вместе с молекулярными биологами и исследователями в области социальных наук.</p>
<p>Сегодня предлагаю посмотреть на статью <a href="https://doi.org/10.1038/s41524-022-00896-3">Extracting structural motifs from pair distribution function data of nanostructures using explainable machine learning</a>, в которой описывается применение машинного обучения для изучения структуры веществ.</p>
<p>Несколько вводных ремарок о принципе работы метода полного рентгеновского рассеяния, данные которого анализируют авторы исследования. Концепция вполне проста для интуитивного понимания: процесс напоминает съемку флюорограммы, но с менее наглядными картинками на выходе.</p>
<figure style="text-align: center;">
  <img src="./PDF.jpg">
  <figcaption>Устройство лабораторного дифрактометра для сбора данных полного рентгеновского рассеяния. Источник излучения (А), держатель образца (Б), один из четырех детекторов (В). Сам образец заключен в тонкий стеклянный капилляр, закрепленный в держателе Б.</figcaption>
</figure>
<p>Вещество облучается жестким рентгеновским излучением, бо́льшая часть которого проходит вещество насквозь и не сохраняет информации о его структуре, а небольшая часть — рассеивается веществом в разные стороны. Установленный рядом детектор (или сборка из нескольких детекторов) регистрирует рассеянную часть излучения, а последующая обработка его интенсивности и угла рассеяния позволяет извлечь информацию о структуре вещества.</p>
<p>Основное ограничение метода заключается в том, что извлекаемой информации недостаточно для прямого однозначного определения координат атомов — это позволяет сделать, например, рентгеноструктурный анализ. В методе полного рассеяния на выходе получается одна кривая, называемая функцией парного распределения (pair distribution function, PDF). Она представляет собой гистограмму распределения межатомных расстояний в веществе.</p>
<figure style="text-align: center;">
  <img src="./ceo2_pdf.jpg" />
  <figcaption align = "center">Фрагмент кристаллической структуры диоксида церия и соотвествующая функция парного распределения. Синими окружностями и стрелками обозначены межатомные расстояния в структуре, проявляющиеся в виде пиков на PDF.</figcaption>
</figure>
<p>Проанализировав эти расстояния, можно сделать косвенные выводы о строении вещества и наличии в нем определенных структурных фрагментов. Подробный анализ данных PDF требует представления об исходной структурной модели вещества, желательно близкой к истинной.</p>
<p>Исходную задачу, которую решали авторы работы, можно сформулировать вот как. Чтобы определить строение исследуемого образца, из относительно крупного структурного фрагмента родственного вещества с известной структурой можно было бы последовательно повырезать фрагменты разного размера и строения и посмотреть, насколько хорошо теоретические PDF, рассчитанные для таких фрагментов, совпадают с экспериментальной PDF. Если совпадение точное, то можно считать, что соответствующая модель структуры верна. Проблема заключается в том, что если в исходной модели содержится 5 атомов, то пробных структур придется перебрать 31, если атомов 10 — около 1000, а если атомов 30 (что не редкость и далеко не предел) — то больше миллиарда. Это сильно увеличивает стоимость расчета, и, кроме этого, возникает еще одна проблема. Если для нескольких различных пробных структур сходство с экспериментом одинаково хорошее, то как выбрать единственно верную?</p>
<p>Исследователи предложили подход, основанный на алгоритме с элегантным русским названием «градиентный бустинг над решающими деревьями» (gradient boosting decision trees, GBDT). На первом этапе создается каталог пробных структур путем случайного вырезания фрагментов различного размера и строения из исходной крупной структуры. Затем для каждой сгенерированной структуры из каталога рассчитывается теоретическая PDF и сравнивается с экспериментальной. Количественным выражением сходства является фактор достоверности R, принимающий значения от 0 (полное сходство) до 1 (полное отутствие сходства). Затем пробные структуры и значения R-фактора используются в качестве входных данными для алгоритма GBDT.</p>
<p>Суть его работы заключается в проведении регрессионного анализа для ответа на вопрос относительно каждого атома исходной большой структуры, улучшается или ухудшается сходство теоретической и экспериментальной PDF при включении этого атома в модель структуры. Алгоритм выбирает произвольный атом, к которому последовательно добавляются новые атомы, и на основании результатов уточнения для пробных структур принимается решение, станет ли расчетная PDF лучше или хуже на основании значений R-фактора. Таким образом алгоритм сортирует атомы по «важности» для конкретной экспериментальной PDF; при этом самые важные атомы образуют наиболее вероятную структурную модель исследуемого вещества.</p>
<p>Ученые подтвердили достоверность разработанного подхода на трех различных модельных системах: фуллерене C<sub>60</sub>, аморфном оксиде молибдена MoO<sub>x</sub>, полиоксовольфрамате, содержащем фрагмент W<sub>12</sub>O<sub>40</sub>. Авторы отмечают, что алгоритм не только надежно предсказывает правильные структурные фрагменты для рассмотренных модельных систем, но и работает значительно быстрее простого перебора миллиардов вариантов структур — 100 секунд против 3 миллионов лет.</p>
<p>Одним из очевидных ограничений алгоритма является необходимость наличия искомой структурной модели в исходной крупной структуре, чтобы алгоритм мог ее идентифицировать. В то же время, алгоритм достаточно быстр для совместного использования с <a href="https://pdfitc.org">другими подходами</a> к поиску структурных моделей на основании данных PDF.</p>

        </section>
        <div class="post-tags">
          
          
          
        </div>
      </div>

      
      
    </div>

    </article>
</main>
<footer>
  <div style="display:flex"></div>
  <div class="footer-info">
    2025  © Dimitry Grebenyuk  
  </div>
</footer>




<script defer src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.17/d3.min.js"></script>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/topojson/1.6.9/topojson.min.js"></script>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/datamaps/0.5.9/datamaps.world.min.js"></script>
</div>
    </body>
</html>
